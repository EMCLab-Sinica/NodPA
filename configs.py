from utils import (
    load_data_mnist,
    load_data_cifar10,
    load_data_google_speech,
    load_har,
    load_data_omniglot,
)

# intermediate_values_size should < 65536, or TI's compiler gets confused
configs = {
    'mnist': {
        'onnx_model': 'data/mnist-8.onnx',
        'scale': 4,
        'input_scale': 4,
        'num_slots': 2,
        'intermediate_values_size': 26000,
        'data_loader': load_data_mnist,
        'n_all_samples': 10000,
        'sample_size': [1, 28, 28],
        'op_filters': 4,
        'first_sample_outputs': [ -1.247997, 0.624493, 8.609308, 9.392411, -13.685033, -6.018567, -23.386677, 28.214134, -6.762523, 3.924627 ],
        'fp32_accuracy': 0.9890,
    },
    'cifar10': {
        'onnx_model': 'data/squeezenet_cifar10.onnx',
        'scale': 2,
        'input_scale': 4,
        'num_slots': 3,
        'intermediate_values_size': 65000,
        'data_loader': load_data_cifar10,
        'n_all_samples': 10000,
        'sample_size': [32, 32, 3],
        'op_filters': 4,
        'first_sample_outputs': [ 0.000830, 0.000472, 0.000637, 0.678688, 0.000534, 0.310229, 0.001407, 0.003931, 0.002062, 0.001210 ],
        'fp32_accuracy': 0.7704,
    },
    'kws': {
        'onnx_model': 'data/KWS-DNN_S.onnx',
        'scale': 1,
        'input_scale': 120,
        'num_slots': 2,
        'intermediate_values_size': 20000,
        'data_loader': load_data_google_speech,
        'n_all_samples': 4890,
        'sample_size': [25, 10],  # MFCC gives 25x10 tensors
        'op_filters': 4,
        'first_sample_outputs': [ 0.000000, 0.000000, 0.998193, 0.000000, 0.000000, 0.000000, 0.001807, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000 ],
        'fp32_accuracy': 0.7983,
    },
    'har': {
        'onnx_model': 'data/HAR-CNN.onnx',
        'scale': 2,
        'input_scale': 16,
        'num_slots': 2,
        'intermediate_values_size': 20000,
        'data_loader': load_har,
        'n_all_samples': 2947,
        'sample_size': [9, 128],
        'op_filters': 4,
        'first_sample_outputs': [ -6.194588, 2.2284777, -13.659239, -1.4972568, 13.473643, -10.446839 ],
        'fp32_accuracy': 0.9121,
    },
    'omniglot': {
        'onnx_model': 'data/maml.onnx',
        'scale': 4,
        'input_scale': 4,
        'num_slots': 2,
        'intermediate_values_size': 30000,
        'data_loader': load_data_omniglot,
        'n_all_samples': 5 * 20,  # 5-way (classes), each with 20 samples
        'sample_size': [1, 28, 28],
        'op_filters': 4,
        'first_sample_outputs': [ -0.230564, -0.879236, -0.910271, -0.212429, 0.534965 ],
        'fp32_accuracy': 0,
    },
}

